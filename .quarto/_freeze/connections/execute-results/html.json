{
  "hash": "258e084a92fc21270f330a8bd33e1d12",
  "result": {
    "markdown": "---\ntitle: \"Linear models\"\nformat:\n  html:\n    toc: true\n    html-math-method: katex\n    css: styles.css\n    code-fold: true\n    code-summary: \"Show the code\"\neditor: visual\n---\n\n\n\n\n## Setup\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- read_excel(\"data/results-survey.xlsx\")\ndata <- data[1:121] %>% \n  filter(.[[18]] !='Yes') # not analysed any EEG method\n```\n:::\n\n\n## Experience factor\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm = FAMD(exp_data[1:5], ncp=2, axes=c(1,2))\n```\n\n::: {.cell-output-display}\n![](connections_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](connections_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](connections_files/figure-html/unnamed-chunk-4-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](connections_files/figure-html/unnamed-chunk-4-4.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](connections_files/figure-html/unnamed-chunk-4-5.png){width=672}\n:::\n\n```{.r .cell-code}\n# pics <- fviz_famd_ind(m, col.ind = \"cos2\", \n#              gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"),\n#              repel = TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfactor_scores <- as.data.frame(m$ind$coord)\nhead(factor_scores)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        Dim.1      Dim.2\n1 -0.47174407  1.4097273\n2 -0.42577958  0.3429289\n3  0.05764252 -0.3374638\n4  0.43679041 -1.2564451\n5 -0.08151050 -0.4608666\n6  0.45156717 -1.2526304\n```\n:::\n\n```{.r .cell-code}\ncbind(data[20], factor_scores[1])  %>% \n   rename_at(vars(colnames(.)), ~ c(\"years\", \"proxy\")) %>% \n  with(cor.test( proxy, years)) %>% \n  broom::tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 8\n  estimate statistic   p.value parameter conf.low conf.high method       alter…¹\n     <dbl>     <dbl>     <dbl>     <int>    <dbl>     <dbl> <chr>        <chr>  \n1    0.964      52.9 1.02e-123       211    0.953     0.973 Pearson's p… two.si…\n# … with abbreviated variable name ¹​alternative\n```\n:::\n\n```{.r .cell-code}\n  #lm(data=.,years ~ proxy) %>% summary(.)\n```\n:::\n\n\n## Experience and ...\n\n### Up or down\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncbind(data[79], factor_scores[1])  %>% \n   rename_at(vars(colnames(.)), ~ c(\"ud\", \"proxy\")) %>% filter(!is.na(ud)) %>% \n  mutate(ud = ifelse(ud==\"Up\", 1, 0)) %>% \n  t.test( proxy ~ ud , data=.) %>% \n  broom::tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 10\n  estim…¹ estim…² estim…³ stati…⁴ p.value param…⁵ conf.…⁶ conf.…⁷ method alter…⁸\n    <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>  <chr>  \n1  -0.103 -0.0667  0.0368  -0.706   0.481    191.  -0.393   0.186 Welch… two.si…\n# … with abbreviated variable names ¹​estimate, ²​estimate1, ³​estimate2,\n#   ⁴​statistic, ⁵​parameter, ⁶​conf.low, ⁷​conf.high, ⁸​alternative\n```\n:::\n\n```{.r .cell-code}\ncbind(data[79], factor_scores[1])  %>% \n   rename_at(vars(colnames(.)), ~ c(\"ud\", \"proxy\")) %>% filter(!is.na(ud)) %>% \n  ggplot(., aes(x=as.factor(ud), y = proxy)) + \n  geom_boxplot() + labs(x = \"Aware or not abour colorbar controvercies\", y = \"Experience\") +  theme_classic()\n```\n\n::: {.cell-output-display}\n![](connections_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n### Colorbars\n\n\n::: {.cell}\n\n:::\n\n\n### Tools\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvec <- names(data[25:51]) %>% str_split_i(., \"\\\\? \\\\[\", 2) %>%  str_sub(., 1, -2)\n\nsoftware <- data[25:51] %>%\n    rename_at(vars(colnames(.)), ~ vec) %>% #mutate(`Custom scripts` = ifelse(Other == \"Custom scripts\", \"Yes\", `Custom scripts`)) %>% \n  dplyr::select(-Other) %>% \n  mutate_at(vars(vec[1:26]), function(., na.rm = FALSE) (x = ifelse(.==\"Yes\", 1, 0))) %>% \n  cbind(data[20], .) %>% dplyr::rename(years = !!names(.)[1]) %>% filter(years < 50) %>% \n  select_if(colSums(.) != 0)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\na <- software  %>% \n  select_if(colSums(.) > 10) \n\nres <- a %>%  dplyr::select(years, BESA) %>% \n  group_by(BESA) %>% dplyr::summarise(mean(years)) %>% dplyr::rename(., Usage = BESA, BESA = `mean(years)`)\n\ncn <- colnames(a[3:length(a)])\nfor (i in 1:length(cn)){\n  tmp <- a %>%  dplyr::select(years, cn[i]) %>% \n  group_by_at(2) %>% dplyr::summarise( mean(years)) %>%  dplyr::select(-1)\n  colnames(tmp) <- cn[i] \n  res <- cbind(res, tmp) \n  #print(cn[i])\n}\n res %>% t()  %>%\n  row_to_names(row_number = 1) %>% data.frame() %>% dplyr::rename(., not_used = X0, used = X1) %>% \n  tibble::rownames_to_column(., \"software\") %>%  \n  dplyr::mutate(., not_used = round(not_used, 2), used = round(used, 2)) %>% \n  dplyr::mutate(., status = ifelse(not_used > used, \"younger\", \"older\")) %>% \n  mutate(status = cell_spec(status, color = ifelse(status == \"younger\", \"green\", \"black\")))   %>% \n  kable(escape = F, booktabs = T) %>% kable_styling(\"striped\", position = \"center\",) %>%\n   add_header_above(header = c(\" \" = 1, \"Mean years of user experience\" = 3))   %>%\n  kable_classic(full_width = T, html_font = \"Arial\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped lightable-classic\" style=\"margin-left: auto; margin-right: auto; font-family: Arial; margin-left: auto; margin-right: auto;\">\n <thead>\n<tr>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"3\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Mean years of user experience</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:left;\"> software </th>\n   <th style=\"text-align:right;\"> not_used </th>\n   <th style=\"text-align:right;\"> used </th>\n   <th style=\"text-align:left;\"> status </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> BESA </td>\n   <td style=\"text-align:right;\"> 7.45 </td>\n   <td style=\"text-align:right;\"> 9.92 </td>\n   <td style=\"text-align:left;\"> <span style=\"     color: black !important;\">older</span> </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Brainstorm </td>\n   <td style=\"text-align:right;\"> 7.26 </td>\n   <td style=\"text-align:right;\"> 9.29 </td>\n   <td style=\"text-align:left;\"> <span style=\"     color: black !important;\">older</span> </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Brain Vision Analyser </td>\n   <td style=\"text-align:right;\"> 7.39 </td>\n   <td style=\"text-align:right;\"> 8.35 </td>\n   <td style=\"text-align:left;\"> <span style=\"     color: black !important;\">older</span> </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EEGLAB </td>\n   <td style=\"text-align:right;\"> 5.95 </td>\n   <td style=\"text-align:right;\"> 8.58 </td>\n   <td style=\"text-align:left;\"> <span style=\"     color: black !important;\">older</span> </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ERPLAB </td>\n   <td style=\"text-align:right;\"> 7.18 </td>\n   <td style=\"text-align:right;\"> 9.16 </td>\n   <td style=\"text-align:left;\"> <span style=\"     color: black !important;\">older</span> </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> FieldTrip </td>\n   <td style=\"text-align:right;\"> 6.89 </td>\n   <td style=\"text-align:right;\"> 8.44 </td>\n   <td style=\"text-align:left;\"> <span style=\"     color: black !important;\">older</span> </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LIMO </td>\n   <td style=\"text-align:right;\"> 7.37 </td>\n   <td style=\"text-align:right;\"> 10.60 </td>\n   <td style=\"text-align:left;\"> <span style=\"     color: black !important;\">older</span> </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> MNE-Python </td>\n   <td style=\"text-align:right;\"> 7.94 </td>\n   <td style=\"text-align:right;\"> 7.12 </td>\n   <td style=\"text-align:left;\"> <span style=\"     color: green !important;\">younger</span> </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> SPM </td>\n   <td style=\"text-align:right;\"> 7.51 </td>\n   <td style=\"text-align:right;\"> 8.58 </td>\n   <td style=\"text-align:left;\"> <span style=\"     color: black !important;\">older</span> </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Unfold </td>\n   <td style=\"text-align:right;\"> 7.55 </td>\n   <td style=\"text-align:right;\"> 8.31 </td>\n   <td style=\"text-align:left;\"> <span style=\"     color: black !important;\">older</span> </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Custom scripts </td>\n   <td style=\"text-align:right;\"> 7.23 </td>\n   <td style=\"text-align:right;\"> 8.22 </td>\n   <td style=\"text-align:left;\"> <span style=\"     color: black !important;\">older</span> </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\n### Number of used software\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvec <- names(data[25:50]) %>% str_split_i(., \"\\\\? \\\\[\", 2) %>%  str_sub(., 1, -2)\n\nsoftware <- data[25:50] %>%\n    rename_at(vars(colnames(.)), ~ vec) %>% \n  mutate_at(vars(vec), function(., na.rm = FALSE) (x = ifelse(.==\"Yes\", 1, 0))) \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncbind(data.frame(rowSums(software)), factor_scores[1])  %>% \n   rename_at(vars(colnames(.)), ~ c(\"n_soft\", \"experience\")) %>% \n  filter(n_soft > 0) %>% \n  ggplot(., aes(x=n_soft, y=experience)) + geom_jitter() + geom_smooth()\n```\n\n::: {.cell-output-display}\n![](connections_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncbind(data.frame(rowSums(software)), factor_scores[1])  %>% \n   rename_at(vars(colnames(.)), ~ c(\"n_soft\", \"experience\")) %>% \n  filter(n_soft > 0) %>% \n  lm(data=., n_soft ~ experience) %>% summary(.)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = n_soft ~ experience, data = .)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-2.2263 -1.0671 -0.0685  0.9654  7.9333 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  3.03351    0.12359  24.546   <2e-16 ***\nexperience   0.10920    0.08584   1.272    0.205    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.795 on 209 degrees of freedom\nMultiple R-squared:  0.007684,\tAdjusted R-squared:  0.002936 \nF-statistic: 1.618 on 1 and 209 DF,  p-value: 0.2047\n```\n:::\n:::\n\n\n### Features\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfeature <- data[52:60] %>% rename_all(., ~str_split_i(colnames(data[52:60]), \"\\\\? \\\\[\", 2) %>% \n                                        str_sub(., 1, -2) ) %>%  \n  mutate_at(c(colnames(.)), \n        funs(recode(.,\n        \"Very important\"= 2, \"Important\"= 1, \"Neutral\"= 0,\n        \"Low importance\"= -1, \"Not at all important\" = -2 )))  %>% \n  cbind(., factor_scores[1]) %>% \n    filter_all(all_vars(!is.na(.))) %>%  \n  rename_at(vars(colnames(.)), ~ c(\"subplot\", \"attributes\", \"speed\", \"publicable\", \"reproducable\", \n                                   \"zooming\", \"interactive\", \"gui\", \"coding\", \"experience\")) %>% \n  mutate(experience = round(experience, 2), exp_cut = cut(experience, 4, labels = c(\"25%\", \"50%\", \"75%\", \"100%\")), \n         exp_quant = factor(ntile(experience, 4))) %>% \n  group_by(exp_quant) %>% dplyr::mutate(n = n()) %>% ungroup() \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(feature$exp_quant)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n 1  2  3  4 \n50 50 49 49 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfeature %>% \n  pivot_longer(cols = subplot:coding, names_to = \"feature\", values_to = \"likert\") %>% \n  mutate(likert = likert + 3) %>% \n  group_by(feature, exp_quant) %>% dplyr::summarise(m = mean(likert)) %>% \n  ggplot(aes(y = m, x= exp_quant, fill = exp_quant)) + \n  geom_bar(stat = \"identity\") + \n  #geom_smooth(aes(y = value, x= experience, color = str_wrap(name, 20)), bw = 0.5, method = \"loess\", span = 0.7) + \n  labs(y = \"Mean likert scale value\", x=\"Experience quartiles\", color = \"Features\")  + theme_classic() +\n  theme(legend.position = \"none\", \n        legend.key.height=unit(2, \"cm\"), \n        axis.text.x = element_text(size = 12),\n        strip.text = element_text(size = 14)) + \n  facet_wrap(~str_wrap(feature, 20)) + \n  geom_text(aes(label = paste0(round(m, 1))),  position = position_stack(vjust = 0.5), size = 4) \n```\n\n::: {.cell-output-display}\n![](connections_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfeature %>% \n  pivot_longer(cols = subplot:coding, names_to = \"feature\", values_to = \"likert\") %>%\n  mutate(likert = likert + 3) %>%\n  ggplot(aes(x = likert, fill= experience, colour = exp_quant)) + \n  geom_density(key_glyph = \"timeseries\", bw = 0.5) +\n  labs(x = \"Mean likert scale value\", y=\"Experience quartiles\", color = \"Experience\\nquantiles\")  + \n  theme_classic() + scale_colour_brewer(palette = \"Spectral\") +\n  theme(legend.position = \"right\", \n        #legend.key.height=unit(2, \"cm\"), \n        axis.text.x = element_text(size = 12),\n        strip.text = element_text(size = 14)) + \n  facet_wrap(~str_wrap(feature, 20)) \n```\n\n::: {.cell-output-display}\n![](connections_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n### Channels\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata %>% select(23, 24) %>% \n  cbind(., factor_scores[1]) %>% \n  rename_at(vars(colnames(.)), ~ c(\"measure\", \"analyse\", \"experience\")) %>% \n  filter(analyse < 500) %>% \n  mutate(rate = analyse / measure) %>% \n  ggplot(., aes(x=rate, y=experience)) + \n  geom_point() + geom_smooth() +\n  labs(x =\"analyse / measure\") +\n  theme_classic()\n```\n\n::: {.cell-output-display}\n![](connections_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "connections_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\r\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}