{"title":"3.plot_breakdown","markdown":{"yaml":{"title":"3.plot_breakdown","format":"html","editor":"visual"},"headingText":"Setup","containsRefs":false,"markdown":"\n\n\n```{r, message= FALSE, warning=FALSE}\n# upload to the git\nlibrary(readxl)\nlibrary(foreach)\nlibrary(stringr)\nlibrary(dplyr)\nlibrary(tokenizers)\nlibrary(data.table)\nlibrary(ggplot2)\nlibrary(plyr)\nlibrary(quanteda)\nlibrary(SemNetCleaner)\nlibrary(purrr)\nlibrary(tidytext)\nlibrary(tm)\nlibrary(topicmodels)\nlibrary(SnowballC)\nlibrary(Matrix)\nlibrary(text2vec)\nlibrary(tidyr)\nlibrary(kableExtra)\nlibrary(stringi)\nlibrary(\"xlsx\")\nlibrary(padr)\n```\n\n```{r, message= FALSE, warning=FALSE}\ndata <- read_excel(\"data/results-survey3.xlsx\")\ndata <- data[1:121] %>% \n  filter(.[[18]] !='Yes') # not analysed any EEG method\nvec <- names(data[ , grepl( \"How would you \" , names(data))])\n```\n\n## word_preproc\n\n```{r}\nword_preproc <- function(data, N){\n # N = 69\n  stop_list = c(\"a\", \"an\", \"the\", \"wise\", \"like\", \"s\", \"plot\", \"plots\")\n  tmp <- data %>% filter(!is.na(.[[N]])) %>% select(., N) %>% \n    dplyr::rename(words = !!names(.)[1]) %>% mutate(words = tolower(words)) %>% \n    mutate(words_prep = str_split(words, \"\\\\s+\")) %>%\n    mutate(words_prep = sapply(words_prep, function(x) paste(x[!x %in% stop_list], collapse = \" \"))) %>% \n    mutate(words_prep = stri_replace_all_regex(words_prep,\n                                  pattern=c(\" \\\\(.*\", \", or.*\", \" across.*\", \" with.*\", \" at.*\", \" by.*\", \" over.*\", #\" of.*\", \n                                            \" for.*\", \" per.*\", \" across.*\", \" accross.*\", \" between.*\"),\n                                  replacement=c(''),\n                                  vectorize=FALSE)) %>% \n    mutate(words_prep = str_split(words_prep, \"\\\\s+\")) %>%\n    mutate(words_prep = sapply(words_prep, function(x) paste(x[!x %in% stop_list], collapse = \" \")))\n     \n  return(tmp)\n}\n\n```\n\n## Plot naming\n\nThose who named a plot somehow and those who failed to do that\n\n```{r, warning=FALSE}\nplot_names <- c(\"line\", \"butterfly\", \"topo\", \"topo_map\", \"topo_array\", \"erp_img\", \"parallel\", \"channel_img\")\n\nna_table <- function(data, vec){\n    temp <- data.frame(1:10)\n    for (i in vec){\n      temp1 <- word_preproc(data, i)  %>%\n      mutate(words = ifelse(str_detect(words, 'idea|sure|confus|aware|do not|why'), \"NA\", as.character(words))) %>%\n      mutate(words = ifelse(nchar(words)==0, NA, words)) %>% \n      table(.) %>% \n      data.frame(.) %>% filter(words != \"NA\") %>% \n      summarise(n = sum(Freq))  \n      temp <- cbind(temp, temp1)\n    }\n    temp <- temp[2:length(temp)]\n    colnames(temp) <- plot_names\n    return(temp)\n}\n\nnum_named <- na_table(data, vec)\nslice(num_named, 1)  %>% \n  gather(., plots, succeeded, `line`:`channel_img`, factor_key=TRUE) %>% \n  mutate(failed = nrow(data) - succeeded) %>% \n  gather(., res, score, succeeded:failed, factor_key=TRUE) %>% \n\n  ggplot(., aes(x = plots, y = score, fill = res)) +\n    geom_bar(position = \"dodge\", stat = \"identity\") +\n    labs(x = \"Category\", y = \"Value\", fill = \"Group\") +\n    theme_classic() + theme(axis.title.x=element_blank(), plot.title = element_text(hjust = 0.5)) +\n  geom_text(aes(label = score, group = res), position = position_dodge(width = .9), vjust = -0.2) +\n  ggtitle(\"Plot naming\")\n\n\n```\n\n```{r, warning=FALSE}\nvec <- names(data[ , grepl( \"Have you ever plotted \" , names(data))]) \n\n\ndo_vec <- function(vec, data, plot_names){\n  t1 <- table(data[vec[1]])\n  for (i in 2:length(vec)) {\n    t <- table(data[vec[i]])\n    t1 <- rbind(t1, t)\n  }\n  rownames(t1) <- plot_names #array(paste0(\"t_\", 1:length(vec)))\n  return(t1)\n}\ntab <- do_vec(vec, data, plot_names) %>%  data.frame() %>% tibble::rownames_to_column(., \"plots\") %>%  \n  gather(., type, plotted, `N.A`:`Yes`, factor_key=TRUE) %>% \n  filter(type == \"Yes\") %>% dplyr::select(-type) \n\nmemoried <- slice(num_named, 1)  %>% \n  gather(., plots, succeeded, `line`:`channel_img`, factor_key=TRUE)%>% \n  mutate(failed = nrow(data) - succeeded) %>% \n  dplyr::rename(named = succeeded) %>% \n  dplyr::select(-failed)\n\nfamiliar <-  data[61:68] %>% rename_at(vars(colnames(.)), ~ plot_names) %>% \n  mutate_at(vars(plot_names), function(., na.rm = FALSE) (x = ifelse(.==\"Yes\", 1, 0)))\n\ndata.frame(rowSums(t(familiar))) %>%  tibble::rownames_to_column(., \"plot\") %>% \n   rename_at(vars(colnames(.)), ~ c(\"plots\", \"recognized\")) %>%\n  merge(., memoried)  %>% left_join(., tab)  %>% #filter(plots != \"parallel\") %>% \n  gather(., type, score,  recognized:plotted, factor_key=TRUE) %>% \n  ggplot(., aes(x = reorder(plots, -score), y = score, fill = type)) +\n    geom_bar(position = \"dodge\", stat = \"identity\") +\n    labs(x = \"Plot type\", y = \"Number of users\", fill = \"Level of\\nfamiliarity\\nwith plot\") +\n    theme_classic() + geom_text(aes(label = score, group = type), position = position_dodge(width = .9), vjust = -0.2) +  theme(plot.title = element_text(hjust = 0.5)) +\n  ggtitle(\"Familiarity with plots\")\n```\n\n## The most common names for each plot\n\n#### 1\n\n```{r}\nn1 <- word_preproc(data, 69)  %>%\n   mutate(type = case_when(\n      grepl(\"\\\\b(idea|sure|confus|aware|do not|know|why|remember)\\\\b\", words_prep) == TRUE ~ \"bad\", \n      grepl(\"\\\\baverage(d)?\\\\b.*\\\\b(erp(s)?|ep|related)\\\\b|\\\\b(erp(s)?|ep|related)\\\\b.*\\\\baverage(d)?\\\\b\", words_prep) == TRUE ~ \"averaged erp\",\n      grepl(\"\\\\bwave(form|forms)?\\\\b.*\\\\b(erp(s)?|ep|related)\\\\b|\\\\b(erp(s)?|ep|related)\\\\b.*\\\\bwave(form|forms)?\\\\b\", words_prep) == TRUE ~ \"erp wave(form)s\",\n      grepl(\"\\\\btime(course|series|domain)?\\\\b.*\\\\b(erp(s)?|ep|related)\\\\b|\\\\b(erp(s)?|ep|related)\\\\b.*\\\\btime(course|series|domain)?\\\\b\", words_prep) == TRUE ~ \"erp timecourse (timeseries)\",\n      grepl(\"\\\\b(erp(s)?|ep|related)\\\\b\", words) == TRUE ~ \"erp\",\n      grepl(\"\\\\b(time|timeseries)\\\\b\", words) == TRUE ~ \"time series\",\n      grepl(\"\\\\b(response(s)?)\\\\b\", words) == TRUE ~ \"response\",\n      grepl(\"\\\\b(line|boundedline)\\\\b\", words) == TRUE ~ \"line\",\n      grepl(\"\\\\b(single|singleplot)\\\\b\", words) == TRUE ~ \"single\",\n      grepl(\"\\\\b(waveform(s)?)\\\\b\", words) == TRUE ~ \"waveform\",\n       grepl(\"\\\\b(p300)\\\\b\", words) == TRUE ~ \"p300\",\n      grepl(\"\\\\b(average)\\\\b\", words) == TRUE ~ \"average\",\n      TRUE ~ '_other'\n      ))  %>%# filter(type == \"erp\") %>%  #View()\n   filter(!is.na(type), type != \"bad\") %>% dplyr::select(type) %>%  table(.) %>% \n  data.frame(.) %>% arrange(desc(Freq))  %>% \n   rename_at(vars(colnames(.)), ~ c(\"Line plot\", \"n\")) \nn1 \n```\n\n#### 2\n\n```{r}\nn2 <- word_preproc(data, 80)  %>%\n  mutate(type = case_when(\n      grepl(\"\\\\b(idea|sure|confus|aware|do not|know|why|remember|unsure|confusing|mess)\\\\b\", words_prep) == TRUE ~ \"bad\", \n      grepl(\"\\\\b(butterfly|bitterfly|buterfly|buttefly)\\\\b\", words_prep) == TRUE ~ \"butterfly\",\n      grepl(\"\\\\b(spaghetti)\\\\b\", words_prep) == TRUE ~ \"spaghetti\",\n      grepl(\"\\\\b(time|timeseries|timecourse)\\\\b\", words_prep) == TRUE ~ \"time series\",\n      grepl(\"\\\\b(channel|single|singleplot|individual)\\\\b\", words_prep)  == TRUE ~ \"single or individual channel erp\",\n      grepl(\"\\\\b(channels|multichannel|multeple|multiple|multi|all|muti|electrodes)\\\\b\", words_prep)  == TRUE ~ \"multichannel/electrode erp\",\n      grepl(\"\\\\b(evoked)\\\\b\", words_prep)  == TRUE ~ \"evoked responces\",\n      grepl(\"\\\\b(erp(s)?|eprs|event-related)\\\\b\", words_prep) == TRUE ~ \"erp\",\n      TRUE ~ '_other'\n      )) %>% #filter(type == \"single or individual channel erp\") %>%  #View()\n  filter(!is.na(type), type != \"bad\") %>%\n  dplyr::select(type) %>%  table(.) %>% \n  data.frame(.) %>% arrange(desc(Freq))  %>% \n   rename_at(vars(colnames(.)), ~ c(\"Butterfly_plot\", \"n\")) \nn2\n```\n\n#### 3\n\n```{r}\nn3 <- word_preproc(data, 85)  %>%\n  mutate(type = case_when(\n      grepl(\"\\\\b(idea|sure|confus|aware|do not|know|why|remember|unsure|confusing|mess)\\\\b\", words_prep) == TRUE ~ \"bad\", \n      grepl(\"\\\\b(topo|topoplot(s)?)\\\\b\", words_prep) == TRUE ~ \"topo(plot)\", \n      grepl(\"\\\\b(topomap|topomape)\\\\b\", words_prep) == TRUE ~ \"topomap\",\n      grepl(\"\\\\b(topograph(y|ic|ical|ies)|topgraphy|topograbphy)\\\\b\", words_prep) == TRUE ~ \"topography\",\n      grepl(\"\\\\b(heat(map)?)\\\\b\", words_prep) == TRUE ~ \"heatmap\",\n      grepl(\"\\\\b(map)\\\\b\", words_prep) == TRUE ~ \"scalp map\",\n      grepl(\"\\\\b(distribution)\\\\b\", words_prep) == TRUE ~ \"scalp distribution\",\n      TRUE ~ '_other'\n      )) %>% \n  dplyr::select(type) %>%  table(.) %>% \n  data.frame(.) %>% arrange(desc(Freq))  %>% \n   rename_at(vars(colnames(.)), ~ c(\"Topoplot\", \"n\")) \nn3\n```\n\n#### 4\n\n```{r}\nn4 <- word_preproc(data, 90)  %>%\n  mutate(type = case_when(\n      grepl(\"\\\\b(idea|sure|confus|aware|do not|know|why|remember|unsure|confusing|mess|\\\\?|unclear)\\\\b\", words_prep) == TRUE ~ \"bad\", \n      grepl(\"\\\\btopo(plot|plots)?\\\\b.*\\\\btime(course)?\\\\b|\\\\btime(course)?\\\\b.*\\\\btopo(plot|plots)?|timetopoplot\\\\b\", words_prep) == TRUE ~ \"time topo\",\n      grepl(\"\\\\btopo(plot|plots)?\\\\b.*\\\\bseries\\\\b|\\\\bseries\\\\b.*\\\\btopo(plot|plots)?\\\\b\", words_prep) == TRUE ~ \"topo series\",\n      grepl(\"\\\\b(topo(s)?|topoplot(s)?)\\\\b\", words_prep) == TRUE ~ \"topo\", \n      grepl(\"\\\\b(topomap(s|e)|topomap)\\\\b\", words_prep) == TRUE ~ \"topomap\",\n      grepl(\"\\\\btopograph(y|ic|ical|ies)\\\\b.*\\\\bmap(s)?\\\\b|\\\\bmap(s)?\\\\b.*\\\\btopograph(y|ic|ical|ies)\\\\b\", words_prep) == TRUE ~ \"topographical map\",\n      grepl(\"\\\\btopograph(y|ic|ical|ies)\\\\b.*\\\\btime\\\\b|\\\\btime\\\\b.*\\\\btopograph(y|ic|ical|ies)\\\\b\", words_prep) == TRUE ~ \"time topography\",\n      grepl(\"\\\\b(topograph(y|ic|ical|ies)|topgraphy|topograhy|topograbphy|topgraphies)\\\\b\", words_prep) == TRUE ~ \"topography\",\n      grepl(\"\\\\b(heat(map)?)\\\\b\", words_prep) == TRUE ~ \"heatmap\",\n      grepl(\"\\\\b(map(s)?)\\\\b\", words_prep) == TRUE ~ \"scalp map\",\n      grepl(\"\\\\b(time(series)?|serie(s)?)\\\\b\", words_prep) == TRUE ~ \"time series\",\n      grepl(\"\\\\b(distribution)\\\\b\", words_prep) == TRUE ~ \"scalp distribution\",\n      TRUE ~ '_other'\n      )) %>%  #View()\n  dplyr::select(type) %>%  table(.) %>% \n  data.frame(.) %>% arrange(desc(Freq)) %>% filter(type != \"bad\")  %>% \n   rename_at(vars(colnames(.)), ~ c(\"Topo map\", \"n\")) \nn4\n```\n\n#### 5\n\n```{r}\nn5 <- word_preproc(data, 97)  %>%\n  mutate(type = case_when(\n      grepl(\"\\\\b(idea|sure|confus|aware|do not|know|why|remember|unsure|confusing|mess|\\\\?|unclear|-|ugly|don't|useless)\\\\b\", words_prep) == TRUE ~ \"bad\", \n      grepl(\"\\\\btopograph(y|ic|ical|ies)?|toprgraphic\\\\b.*\\\\berp(s)?\\\\b|\\\\berp(s)?\\\\b.*\\\\btopograph(y|ic|ical|ies)?|toprgraphic\\\\b\", words_prep) == TRUE ~ \"topographic erp\",\n      grepl(\"\\\\btopo(plot|plots)?\\\\b.*\\\\berp(s)?\\\\b|\\\\berp(s)?\\\\b.*\\\\btopo(plot|plots)?\\\\b\", words_prep) == TRUE ~ \"topo erp\",\n      grepl(\"\\\\b(erp(s)?|eprs|event-related)\\\\b\", words_prep) == TRUE ~ \"erp\",\n      grepl(\"\\\\b(multi(plot|channel|ploter|ploterp)|multi)\\\\b\", words_prep) == TRUE ~ \"multi or multichannel plot\",\n      grepl(\"\\\\b(topo(s)?|topoplot(s)?)\\\\b\", words_prep) == TRUE ~ \"topo\", \n      grepl(\"\\\\b(topograph(y|ic|ical|ies)?|topgraphy|topograhy|topograbphy|topgraphies)\\\\b\", words_prep) == TRUE ~ \"topography\",\n      grepl(\"\\\\b(channel(s|plot)?)\\\\b\", words_prep) == TRUE ~ \"channel\",\n      grepl(\"\\\\b(time(series)?|serie(s)?)\\\\b\", words_prep) == TRUE ~ \"time series\",\n      grepl(\"\\\\b(scalp)\\\\b\", words_prep) == TRUE ~ \"scalp\",\n      TRUE ~ '_other'\n      )) %>% #filter(type==\"erp\") %>% View()\n  dplyr::select(type) %>%  table(.) %>% \n  data.frame(.) %>% arrange(desc(Freq)) %>% filter(type != \"bad\")  %>% \n   rename_at(vars(colnames(.)), ~ c(\"Topo array\", \"n\")) \nn5\n\n```\n\n#### 6\n\n```{r}\nn6 <- word_preproc(data, 102)  %>%\n  mutate(type = case_when(\n      grepl(\"\\\\b(idea|sure|confus|aware|do not|know|why|good|remember|unsure|confusing|mess|\\\\?|\\\\?\\\\?|unclear|-|ugly|don't|x|useless)\\\\b\", words_prep) == TRUE ~ \"bad\", \n      grepl(\"\\\\bimage\\\\b.*\\\\berp(s)?\\\\b|\\\\berp(s)?\\\\b.*\\\\bimage|erpimage|image\\\\b\", words_prep) == TRUE ~ \"erp image\",\n      grepl(\"\\\\bimage\\\\b.*\\\\bepoch(s)?\\\\b|\\\\bepoch(s)?\\\\b.*\\\\bimage\\\\b\", words_prep) == TRUE ~ \"epoch image\",\n      grepl(\"\\\\b(raster(plot)?)\\\\b\", words_prep) == TRUE ~ \"raster\",\n      grepl(\"\\\\b(waterfall)\\\\b\", words_prep) == TRUE ~ \"waterfall\",\n      grepl(\"\\\\b(heat(map)?)\\\\b\", words_prep) == TRUE ~ \"heatmap\",\n      grepl(\"\\\\b(sort(ed)?)\\\\b\", words_prep) == TRUE ~ \"sorted trials\",\n      grepl(\"\\\\b(erp(s)?|eprs|ersp|event-related)\\\\b\", words_prep) == TRUE ~ \"erp\",\n      grepl(\"\\\\b(voltage)\\\\b\", words_prep) == TRUE ~ \"voltage\",\n      grepl(\"\\\\b(time(series)?|serie(s)?)\\\\b\", words_prep) == TRUE ~ \"time series or frequencies\",\n      grepl(\"\\\\b(trial(s|wise)?|trialplot)\\\\b\", words_prep) == TRUE ~ \"trial or trial variations\",\n      TRUE ~ '_other'\n      )) %>% #View()\n  dplyr::select(type) %>%  table(.) %>%  \n  data.frame(.) %>% arrange(desc(Freq)) %>% filter(type != \"bad\")  %>% \n   rename_at(vars(colnames(.)), ~ c(\"ERP image\", \"n\")) \nn6\n```\n\n#### 7\n\n```{r}\nn7 <- word_preproc(data, 107)  %>%\n  mutate(type = case_when(\n      grepl(\"\\\\b(idea|sure|confus|aware|do not|know|why|good|remember|unsure|confusing|mess|\\\\?|\\\\?\\\\?|unclear|-|ugly|don't|x|useless)\\\\b\", words_prep) == TRUE ~ \"bad\", \n      grepl(\"\\\\b(amplitude(s)?)\\\\b\", words_prep) == TRUE ~ \"amplitudes\",\n      TRUE ~ '_other'\n      )) %>% #View()\n  dplyr::select(type) %>%  table(.) %>% \n  data.frame(.) %>% arrange(desc(Freq)) %>% filter(type != \"bad\")  %>% \n   rename_at(vars(colnames(.)), ~ c(\"Parallel plot\", \"n\")) \nn7\n```\n\n#### 8\n\n```{r}\nn8 <- word_preproc(data, 112)  %>%\n  mutate(type = case_when(\n      grepl(\"\\\\b(idea|sure|confus|aware|do not|know|why|good|remember|unsure|confusing|mess|normal|\\\\?|\\\\?\\\\?|unclear|recall|-|ugly|don't|x|useless|nan|clear)\\\\b\", words_prep) == TRUE ~ \"bad\", \n      grepl(\"\\\\bimage\\\\b.*\\\\berp(s)?\\\\b|\\\\berp(s)?\\\\b.*\\\\bimage|erpimage\\\\b\", words_prep) == TRUE ~ \"erp image\",\n      grepl(\"\\\\bimage\\\\b.*\\\\bchannel\\\\b|\\\\bchannel\\\\b.*\\\\bimage|chanimage|imagesc\\\\b\", words_prep) == TRUE ~ \"channel image\",\n      grepl(\"\\\\b(heat(map)?)\\\\b\", words_prep) == TRUE ~ \"heatmap\",\n      grepl(\"\\\\b(image)\\\\b\", words_prep) == TRUE ~ \"image\",\n      grepl(\"\\\\b(raster(plot)?|custer)\\\\b\", words_prep) == TRUE ~ \"raster\",\n      grepl(\"\\\\b(matrix)\\\\b\", words_prep) == TRUE ~ \"matrix\",\n      grepl(\"\\\\b(channel(s|wise)?)\\\\b\", words_prep) == TRUE ~ \"channels\",\n      grepl(\"\\\\b(erp(s)?|eprs|ersp|event-related)\\\\b\", words_prep) == TRUE ~ \"erp\",\n      grepl(\"\\\\b(voltage)\\\\b\", words_prep) == TRUE ~ \"voltage\",\n     # TRUE ~ '_other'\n      )) %>% #View()\n  dplyr::select(type) %>%  table(.) %>% \n  data.frame(.) %>% arrange(desc(Freq)) %>% filter(type != \"bad\") %>% \n   rename_at(vars(colnames(.)), ~ c(\"Channel_image\", \"n\")) \n\nn8\nn8 %>% ggplot(data = ., aes(y = reorder(Channel_image, n),  x= n, fill = Channel_image)) +\n    geom_bar(stat=\"identity\") + ylab(\"Channel plot\") +\n    geom_text(aes(label = n), \n    hjust = -0.2) + theme_classic() + theme(legend.position=\"none\")\n\n```\n\n#### Combined\n\n```{r}\nlist(n1, n2, n3, n4, n5, n6, n8) %>% kable(.) %>% kable_styling(\"striped\", position = \"center\",) \n```\n\n## Struggles with plots\n\n```{r}\nvec <- names(data[ , grepl( \".*Which parts of*.\" , names(data))])\n```\n\n```{r, warning=FALSE}\nword_preproc_tool_2 <- function(data, N, lim){\n  #lim = 10\n  tmp <- data %>% dplyr::select(N, N+1, N+2) %>% dplyr::rename(soft = !!names(.)[1], parts = !!names(.)[2], new_feature = !!names(.)[3]) %>% \n    filter(!is.na(soft)) %>% \n    mutate_at(vars(colnames(.)), funs(tolower(.))) %>% \n    mutate(soft = str_replace(soft, 'own', \"custom\"), \n           soft = str_replace(soft, '(matlab)', \"matlab\"), \n           soft = case_when(\n      str_detect(soft, 'brain vision') ~ \"brain vision analyser\",\n      #str_detect(soft, 'matlab|bar.m|boundedline') ~ \"custom matlab\",\n      str_detect(soft, 'mne') ~ \"mne\",\n      TRUE ~ as.character(soft)\n    ), \n    parts = case_when(\n      str_detect(parts, 'none|n/a|nope|na|idk|nothing|sure|know|can\\'t|don\\'t') ~ \"-\",\n      TRUE ~ as.character(parts)\n    ),\n    new_feature = case_when(\n      str_detect(new_feature, 'none|n/a|nope|na|idk|nothing|sure|know|can\\'t|don\\'t') ~ \"-\",\n      TRUE ~ as.character(new_feature)\n    )) %>% \n  \n    filter_at(vars(parts, new_feature), all_vars(!is.na(.))) %>% mutate(n = lengths(gregexpr(\"\\\\W+\", soft)) + 1) %>% \n    filter(parts != \"-\" | new_feature != \"-\", n < lim) %>%  dplyr::select(-4) %>% arrange(soft)\n  return(tmp)\n}\n```\n\n#### 1\n\n```{r, warning=FALSE}\nstruggle1 <- word_preproc_tool_2(data, 71, 10) \nseparated_row <- separate_rows(struggle1[98, ], parts, sep = \",|\\\\.\") %>% dplyr::select(parts)\n\nstruggle2 <- struggle1 %>% filter( parts != \"-\") %>% dplyr::select(parts) %>% \n  filter(!row_number() %in% c(2, 11, 40, 41, 69, 78, 83, 87, 89, 91))  %>% \n  separate_rows(parts, sep = \"2\\\\)\", convert = FALSE) %>% \n  separate_rows(parts, sep = \"\\\\\\r\\\\\\n\", convert = FALSE) %>%  rbind(., separated_row) %>%\n  mutate(problems = case_when(\n      grepl(\"\\\\b(ci|se|sem|errorbar(s)?|sme|sd|uncertainty|error(s)?|confidence|variance|deviation(s)?|shading|shaded|bars|transparency)\\\\b\", parts) == TRUE ~ \"uncertainty\", \n      grepl(\"\\\\b(axes|lable(s)?|label(s)?|legend|ticks)\\\\b\", parts) == TRUE ~ \"plot components\\n(axes, lables, legend)\", \n      grepl(\"\\\\b(color(s)?|colour(s)?|proportion(s)?|publication|scal(e|ing))\\\\b\", parts) == TRUE ~ \"styling\", \n      grepl(\"\\\\b(preprocessing|extracting|datatype)\\\\b\", parts) == TRUE ~ \"preprocessing\", \n      grepl(\"\\\\b(syncronisation|organizing|groups)\\\\b\", parts) == TRUE ~ \"subplotting\", \n      grepl(\"\\\\b(mean|significan(t|ce)|permutations|combine)\\\\b\", parts) == TRUE ~ \"statistics\", \n      )) %>% filter(nchar(parts) != 0) %>% filter(!is.na(problems)) \nn_rest <- nrow(data) - nrow(struggle2)\n\nstruggle3 <- struggle2 %>% group_by(problems) %>%\n      dplyr::summarise(n = n()) %>% \n      rbind(c(\"no complains\", as.numeric(n_rest))) %>% \n      mutate(n = as.numeric(n)) %>% \n      mutate(percent = round(n / sum(n), 3) * 100 ,percent1 = round(n / sum(n), 2) * 100) \n\nstruggle3 %>% \n  arrange(desc(n)) %>% \n  kable(escape = F, booktabs = T) %>% kable_styling(\"striped\", position = \"center\",) %>% \n  kable_classic(full_width = F, html_font = \"Arial\")\n\n # words = ifelse(nchar(words)==0, NA, words),\n #  write.xlsx(., \"data/struggles.xlsx\", sheetName = \"line plot\", col.names = TRUE, row.names = TRUE, append = FALSE)\n\n# problems: n of problems is higher than number of rows, \n```\n\n```{r}\nstruggle3 %>% \n  arrange(desc(n)) %>% \n  ggplot(., aes(y = reorder(problems, percent), x = percent, fill = problems)) +\n  geom_col() +\n  geom_text(aes(label = paste0(percent, \"%\"), y = problems, x = percent),\n            position = position_stack(vjust = 0.5), color = \"black\") +\n  labs(x = \"Percent\", y  = \"Problem category\") +\n  theme_classic() +\n  theme(axis.text = element_text(size = 12), legend.position = \"none\")\n```\n\n## New features\n\n<!-- ## Frequency of tool usage -->\n\n<!-- ```{r} -->\n\n<!-- vec <- names(data[ , grepl( \".*Which plotting\" , names(data))]) %>% str_split_i(., \"\\\\? \\\\]\", 2) %>%  -->\n\n<!--   str_split_i(., \"\\\\...\", 2) %>% as.numeric() -->\n\n<!-- ``` -->\n\n<!-- ```{r} -->\n\n<!-- word_preproc_tool <- function(data, N, lim){ -->\n\n<!--   N = 71 -->\n\n<!--   #lim = 10 -->\n\n<!--   tmp <- data %>% dplyr::select(N) %>% filter(!is.na(.)) %>% dplyr::rename(words = !!names(.)[1]) %>%  -->\n\n<!--     mutate(words = ifelse(str_detect(words, 'own|costum'), \"custom\", as.character(words))) %>%  -->\n\n<!--   mutate(n = lengths(gregexpr(\"\\\\W+\", words)) + 1) %>% arrange(desc(n)) -->\n\n<!--   rest <- tmp %>% filter(n >= lim) %>% dplyr::select(words) -->\n\n<!--   tmp <- tmp %>% filter(n < lim) %>% dplyr::select(words) -->\n\n<!--   t <- foreach(i = 1:nrow(tmp)) %do% strsplit(tmp[[1]][i], \",|/|\\\\|+| and |&| or |\\\\n|\\\\r|;\") -->\n\n<!--   tul <- foreach(i = 1:nrow(tmp)) %do% unlist(t[[i]]) -->\n\n<!--   tul1 <- unlist(tul) -->\n\n<!--   tul2 <- tul1[tul1!=\"\"] -->\n\n<!--   tul2[tul2==\"-\"] <- NA -->\n\n<!--   tul2 <- na.omit(tul2) -->\n\n<!--   #t <- foreach(i = 1:nrow(tmp)) %do% tokenize_words(as.character(tmp[i, N]), strip_punct = FALSE) -->\n\n<!--   stop_list = c(\"a\", \"an\", \"the\", \"wise\", \"by\", \"over\", \"of\", \"per\", \"for\", \"like\", \"s\", \"at\", \"code\", \"script\", \"recently\", \"my\", \"in\", \"written\", \"using\", \"built\", \"function\", \"plot\", \"with\",  \"itself\", \"scripting\", \"scrip\", \"scripts\", \"basic\")#, \"custom\") -->\n\n<!--   t1 <- foreach(i = 1:length(tul2)) %do% tokenize_words(as.character(tul2[i])) -->\n\n<!--   t2 <- foreach(i = 1:length(t1)) %do% map(t1[i][[1]], singularize) -->\n\n<!--   t21 <- foreach(i = 1:length(t2)) %do% tokenize_words(as.character(t2[i][[1]])) -->\n\n<!--   t22 <- foreach(i = 1:length(t21)) %do% t21[i][[1]][[1]][!(t21[i][[1]][[1]] %in% stop_list)] -->\n\n<!--   t3 <- foreach(i = 1:length(t22)) %do% paste((unlist(t22[i])), collapse = ' ')  -->\n\n<!--   t4 <- data.frame(matrix(t3)) #%>% dplyr::rename(words = !!names(.)[1]) -->\n\n<!--   return(c(t4, rest)) -->\n\n<!-- } -->\n\n<!-- ``` -->\n\n<!-- #### 1 -->\n\n<!-- ```{r} -->\n\n<!-- test <- word_preproc_tool(data, 71, 10)  -->\n\n<!-- rest <- test[[2]] -->\n\n<!-- fromrest <- data.frame(words = c(\"fieldtrip\",\"r\", \"matlab\", \"fieldtrip\", \"adobe illustrator\", \"custom matlab\", \"custom matlab\", \"mne\" )) -->\n\n<!-- base <- data.frame(matrix(test[[1]]))%>% dplyr::rename(words = !!names(.)[1])%>%  -->\n\n<!--   mutate(words = ifelse(nchar(words)==0, NA, words)) %>%  -->\n\n<!--   mutate(words = ifelse(str_detect(words, 'brain vision'), \"brain vision analyser\", as.character(words))) %>%  -->\n\n<!--   mutate(words = ifelse(str_detect(words, 'mne'), \"mne\", as.character(words))) %>%  rbind(., fromrest) %>%  -->\n\n<!--   mutate(words = ifelse(str_detect(words, 'ggplot'), \"ggplot\", as.character(words)))  -->\n\n<!-- words <- base %>%  -->\n\n<!--   table(.) %>%  -->\n\n<!--   data.frame(.) %>%  arrange(desc(Freq))  -->\n\n<!-- narrow1 <- base %>%  -->\n\n<!--   mutate(words = ifelse(str_detect(words, 'matlab|bar.m|boundedline'), \"custom matlab\", as.character(words))) %>%  -->\n\n<!--   mutate(words = ifelse(str_detect(words, 'fieldtrip'), \"fieldtrip\", as.character(words))) %>%  -->\n\n<!--   mutate(words = ifelse(str_detect(words, 'eeglab'), \"EEGLAB\", as.character(words))) %>%  -->\n\n<!--   mutate(words = ifelse(str_detect(words, 'erplab'), \"ERPLAB\", as.character(words))) %>%  -->\n\n<!--   mutate(words = ifelse(str_detect(words, 'python|seaborn|matplotlib|plotly'), \"custom python\", as.character(words))) %>% -->\n\n<!--   mutate(words = ifelse(str_detect(words, 'mne'), \"MNE\", as.character(words))) %>% -->\n\n<!--   mutate(words = ifelse(str_detect(words, 'ggplot|\\\\br\\\\b'), \"custom r\", as.character(words))) %>%  -->\n\n<!--   table(.) %>%  -->\n\n<!--   data.frame(.) %>%  arrange(desc(Freq)) -->\n\n<!-- narrow1 %>% head() -->\n\n<!-- ``` -->\n\n<!-- #### 2 -->\n\n<!-- ```{r} -->\n\n<!-- test <- word_preproc_tool(data, 82, 10)  -->\n\n<!-- rest <- test[[2]] -->\n\n<!-- fromrest <- data.frame(words = c(\"fieldtrip\",\"r\", \"matlab\", \"fieldtrip\", \"adobe illustrator\", \"custom matlab\", \"custom matlab\", \"mne\" )) -->\n\n<!-- base <- data.frame(matrix(test[[1]]))%>% dplyr::rename(words = !!names(.)[1])%>%  -->\n\n<!--   mutate(words = ifelse(nchar(words)==0, NA, words)) %>%  -->\n\n<!--   mutate(words = ifelse(str_detect(words, 'brain vision'), \"brain vision analyser\", as.character(words))) %>%  -->\n\n<!--   mutate(words = ifelse(str_detect(words, 'mne'), \"MNE\", as.character(words))) %>%  rbind(., fromrest) %>%  -->\n\n<!--   mutate(words = ifelse(str_detect(words, 'ggplot'), \"ggplot\", as.character(words))) %>%  -->\n\n<!--   mutate(words = ifelse(str_detect(words, 'own|cusom'), \"custom\", as.character(words)))  -->\n\n<!-- words <- base %>%  -->\n\n<!--   table(.) %>%  -->\n\n<!--   data.frame(.) %>%  arrange(desc(Freq))  -->\n\n<!-- narrow2 <- base %>%  -->\n\n<!--   mutate(words = ifelse(str_detect(words, 'matlab|bar.m|boundedline'), \"custom matlab\", as.character(words))) %>%  -->\n\n<!--   mutate(words = ifelse(str_detect(words, 'fieldtrip|fieldteip|field trip'), \"fieldtrip\", as.character(words))) %>%  -->\n\n<!--   mutate(words = ifelse(str_detect(words, 'eeglab'), \"EEGLAB\", as.character(words))) %>%  -->\n\n<!--   mutate(words = ifelse(str_detect(words, 'erplab'), \"ERPLAB\", as.character(words))) %>%  -->\n\n<!--   mutate(words = ifelse(str_detect(words, 'python|seaborn|matplotlib|plotly'), \"custom python\", as.character(words))) %>% -->\n\n<!--   mutate(words = ifelse(str_detect(words, 'ggplot|\\\\br\\\\b'), \"custom r\", as.character(words))) %>%  -->\n\n<!--    mutate(words = ifelse(str_detect(words, 'cartool'), \"cartool\", as.character(words))) %>%  -->\n\n<!--   table(.) %>%  -->\n\n<!--   data.frame(.) %>%  arrange(desc(Freq)) -->\n\n<!-- narrow2 %>% head() -->\n\n<!-- ``` -->\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"plot_breakdown.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.335","editor":"visual","theme":"cosmo","title":"3.plot_breakdown"},"extensions":{"book":{"multiFile":true}}}}}