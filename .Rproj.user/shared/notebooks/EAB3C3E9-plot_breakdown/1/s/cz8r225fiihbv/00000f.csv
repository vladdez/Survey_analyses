"0","na_table <- function(data, vec){"
"0","    temp <- data.frame(1:10)"
"0","    for (i in vec){"
"0","      temp1 <- word_preproc(data, i)  %>%"
"0","      mutate(words = ifelse(str_detect(words, 'idea|sure|confus|aware|do not|why'), ""NA"", as.character(words))) %>%"
"0","      mutate(words = ifelse(nchar(words)==0, NA, words)) %>% "
"0","      table(.) %>% "
"0","      data.frame(.) %>% filter(words != ""NA"") %>% "
"0","      summarise(n = sum(Freq))  "
"0","      temp <- cbind(temp, temp1)"
"0","    }"
"0","    temp <- temp[2:length(temp)]"
"0","    colnames(temp) <- c(""line plot"",""butterfly"",""topoplot"",""topoarray"",""topomap"",""ERP image"",""parallel"",""channel image"")"
"0","    return(temp)"
"0","}"
"0",""
"0","num_named <- na_table(data, vec)"
"0","slice(num_named, 1)  %>% "
"0","  gather(., plots, succeeded, `line plot`:`channel image`, factor_key=TRUE) %>% "
"0","  mutate(failed = nrow(data) - succeeded) %>% "
"0","  gather(., res, score, succeeded:failed, factor_key=TRUE) %>% "
"0",""
"0","  ggplot(., aes(x = plots, y = score, fill = res)) +"
"0","    geom_bar(position = ""dodge"", stat = ""identity"") +"
"0","    labs(x = ""Category"", y = ""Value"", fill = ""Group"") +"
"0","    theme_classic()"
"0",""
