"0","word_preproc_tool <- function(data, N, lim){"
"0","  N = 71"
"0","  #lim = 10"
"0","  tmp <- data %>% dplyr::select(N) %>% filter(!is.na(.)) %>% dplyr::rename(words = !!names(.)[1]) %>% "
"0","    mutate(words = ifelse(str_detect(words, 'own|costum'), ""custom"", as.character(words))) %>% "
"0","  mutate(n = lengths(gregexpr(""\\W+"", words)) + 1) %>% arrange(desc(n))"
"0","  rest <- tmp %>% filter(n >= lim) %>% dplyr::select(words)"
"0","  tmp <- tmp %>% filter(n < lim) %>% dplyr::select(words)"
"0","  "
"0","  t <- foreach(i = 1:nrow(tmp)) %do% strsplit(tmp[[1]][i], "",|/|\\|+| and |&| or |\\n|\\r|;"")"
"0","  tul <- foreach(i = 1:nrow(tmp)) %do% unlist(t[[i]])"
"0","  tul1 <- unlist(tul)"
"0","  tul2 <- tul1[tul1!=""""]"
"0","  tul2[tul2==""-""] <- NA"
"0","  tul2 <- na.omit(tul2)"
"0","  "
"0","  #t <- foreach(i = 1:nrow(tmp)) %do% tokenize_words(as.character(tmp[i, N]), strip_punct = FALSE)"
"0","  stop_list = c(""a"", ""an"", ""the"", ""wise"", ""by"", ""over"", ""of"", ""per"", ""for"", ""like"", ""s"", ""at"", ""code"", ""script"", ""recently"", ""my"", ""in"", ""written"", ""using"", ""built"", ""function"", ""plot"", ""with"",  ""itself"", ""scripting"", ""scrip"", ""scripts"", ""basic"")#, ""custom"")"
"0","  t1 <- foreach(i = 1:length(tul2)) %do% tokenize_words(as.character(tul2[i]))"
"0","  "
"0","  "
"0","  t2 <- foreach(i = 1:length(t1)) %do% map(t1[i][[1]], singularize)"
"0","  t21 <- foreach(i = 1:length(t2)) %do% tokenize_words(as.character(t2[i][[1]]))"
"0","  t22 <- foreach(i = 1:length(t21)) %do% t21[i][[1]][[1]][!(t21[i][[1]][[1]] %in% stop_list)]"
"0","  t3 <- foreach(i = 1:length(t22)) %do% paste((unlist(t22[i])), collapse = ' ') "
"0","  t4 <- data.frame(matrix(t3)) #%>% dplyr::rename(words = !!names(.)[1])"
"0","  return(c(t4, rest))"
"0","}"
