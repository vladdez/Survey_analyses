"0","# does it work?????"
"0","freq_table <- function(data, vec){"
"0","    temp <- data.frame(1:10)"
"0","    for (i in vec){"
"0","     # i = 112"
"0","      "
"0","      temp1 <- word_preproc(data, i)  %>%"
"0","      mutate(words = ifelse(str_detect(words, 'idea|sure|confus|aware|do not|know|why|remember'), ""NA"", as.character(words)),"
"0","      words = ifelse(nchar(words)==0, NA, words),"
"0","      words = ifelse(str_detect(words, 'erps|ep|erp plot|event related potential'), ""erp_plot"", as.character(words)),"
"0","      words = ifelse(str_detect(words, 'terfly|butte'), ""butterfly_plot"", as.character(words)),"
"0","      words = str_replace(words, 'responses', ""response""),  "
"0","      words =  gsub('channels|chanel', 'channel', words) ,"
"0","      "
"0","      words = ifelse(str_detect(words, '.*grand average.*'), ""grand_average_erp_plot"", as.character(words)),"
"0","      words = ifelse(str_detect(words, 'classic'), ""classic_erp_plot"", as.character(words)),"
"0","      words =  gsub('mean|averaged', 'average', words),"
"0","      words =  gsub('course time', 'timecourse', words),"
"0","      words =  gsub('.*timecourse.*', 'time_course_plot', words),"
"0","      words =  gsub('.*erp waveform.*', 'erp_waveform', words),"
"0","      words =  gsub('average condition.*', 'average_condition_erp', words),"
"0","      words =  gsub('electrode', 'channel', words),"
"0","      words = ifelse(str_detect(words, 'terfly|butte'), ""butterfly_plot"", as.character(words)),"
"0","      words = ifelse(str_detect(words, 'spaghetti'), ""spaghetti_plot"", as.character(words)),"
"0","      words = ifelse(str_detect(words, 'all channels'), ""all_channels_erp"", as.character(words)),"
"0","      words = ifelse(str_detect(words, 'single channel erp|single erp|erp of single channels'), ""single_channel_erp"", as.character(words)),"
"0","      words = ifelse(str_detect(words, '.*channel erp.*'), ""channel_erp"", as.character(words)),"
"0","      words = ifelse(str_detect(words, 'amplitude'), ""amplitude"", as.character(words)),"
"0","      words =  gsub('x |multi |muti |multeple ', 'multiple ', words),"
"0","      words =  gsub('several|each|multeple', 'multiple', words),"
"0","              words =  gsub('erpimage', 'erp image', words),"
"0","      words =  gsub('heat map', 'heatmap', words),"
"0","      words =  gsub('topomaps', 'topomap', words),"
"0","      words =  gsub('topoplots', 'topoplot', words),"
"0","      words =  gsub('epochs', 'epoch', words),"
"0","      words =  gsub('trials', 'trial', words),"
"0","      words =  gsub('topographical', 'topographic', words)"
"0","      ) %>% "
"0","      table(.) %>% "
"0","      data.frame(.) %>%  mutate(n = lengths(gregexpr(""\\W+"", words)) + 1) %>% "
"0","        filter(n < 10) %>% dplyr::select(-n) %>% filter(words != """") %>% "
"0","      arrange(desc(Freq))  %>%  head(10) %>% "
"0","      unite(word_freq, c(""words"", ""Freq"")) %>%  filter(!grepl(""NA"", word_freq))"
"0","      if (length(temp1) < 10){"
"0","        na_frame <- as.data.frame(matrix(NA, nrow = 10, ncol = 1))"
"0","        names(na_frame) <- names(temp1)"
"0","        temp1 <- rbind(temp1, na_frame)  %>%  head(10)"
"0","      }"
"0","      "
"0","      temp <- cbind(temp, temp1)"
"0","    }"
"0","    temp <- temp[2:length(temp)]"
"0","    colnames(temp) <- c(""line plot"",""butterfly plot"",""topoplot"",""topoplot array"",""topographic map"",""ERP image"",""parallel plot"",""channel image"")"
"0","    return(temp)"
"0","}"
"0",""
"0","top10 <- freq_table(data, vec)"
"0","top10 %>% "
"0","  kbl() %>% "
"0","  kable_styling()"
